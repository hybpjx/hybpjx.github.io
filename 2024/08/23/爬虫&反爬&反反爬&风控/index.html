<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="基于反爬系统和浏览安全体系相比逆向更加有亲和力，逆向只有最后一刻才能得到成就感 所有反爬的手段只有两个  鉴权阻止进入（开发端拦截） 高频组织数据大面积泄露 &#x2F; 防止服务器崩溃（风控层面）  app 和 web 整体的思想和逻辑是不变的  最开始的本质只是采集数据  &gt;&gt;&gt; 因为我们在获取数据的时候 人为采集太费时间  采集数据 （招投标 工商信息。外卖 等等） 转">
<meta property="og:type" content="article">
<meta property="og:title" content="爬虫&amp;反爬&amp;反反爬&amp;风控">
<meta property="og:url" content="https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&%E5%8F%8D%E7%88%AC&%E5%8F%8D%E5%8F%8D%E7%88%AC&%E9%A3%8E%E6%8E%A7/index.html">
<meta property="og:site_name" content="始識’s 博客">
<meta property="og:description" content="基于反爬系统和浏览安全体系相比逆向更加有亲和力，逆向只有最后一刻才能得到成就感 所有反爬的手段只有两个  鉴权阻止进入（开发端拦截） 高频组织数据大面积泄露 &#x2F; 防止服务器崩溃（风控层面）  app 和 web 整体的思想和逻辑是不变的  最开始的本质只是采集数据  &gt;&gt;&gt; 因为我们在获取数据的时候 人为采集太费时间  采集数据 （招投标 工商信息。外卖 等等） 转">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-08-22T16:15:25.000Z">
<meta property="article:modified_time" content="2025-08-13T17:08:34.160Z">
<meta property="article:author" content="hybpjx">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/hbsn.jpg">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/hbsn.jpg" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/hbsn.jpg">
        
      
    
    <!-- title -->
    <title>爬虫&amp;反爬&amp;反反爬&amp;风控</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="始識’s 博客" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/tags/">标签</a></li><!--
     --><!--
       --><li><a href="/categories/">分类</a></li><!--
     --><!--
       --><li><a href="/friends/">友联</a></li><!--
     --><!--
       --><li><a href="/message/">留言板</a></li><!--
     --><!--
       --><li><a href="/essays/">说说</a></li><!--
     --><!--
       --><li><a href="/masonry/">相册</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/2024/08/23/QQ%E9%9F%B3%E4%B9%90/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2023/10/26/Gin-gorm%E6%97%B6%E9%97%B4%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%A8%A1%E5%9E%8B%E7%B1%BB%E9%87%8D%E5%86%99/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/&text=爬虫&amp;反爬&amp;反反爬&amp;风控"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/&title=爬虫&amp;反爬&amp;反反爬&amp;风控"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/&is_video=false&description=爬虫&amp;反爬&amp;反反爬&amp;风控"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=爬虫&amp;反爬&amp;反反爬&amp;风控&body=Check out this article: https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/&title=爬虫&amp;反爬&amp;反反爬&amp;风控"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/&title=爬虫&amp;反爬&amp;反反爬&amp;风控"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/&title=爬虫&amp;反爬&amp;反反爬&amp;风控"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/&title=爬虫&amp;反爬&amp;反反爬&amp;风控"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/&name=爬虫&amp;反爬&amp;反反爬&amp;风控&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/&t=爬虫&amp;反爬&amp;反反爬&amp;风控"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E5%8F%8D%E7%88%AC%E7%B3%BB%E7%BB%9F%E5%92%8C%E6%B5%8F%E8%A7%88%E5%AE%89%E5%85%A8%E4%BD%93%E7%B3%BB"><span class="toc-number">1.</span> <span class="toc-text">基于反爬系统和浏览安全体系</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E5%AD%A6"><span class="toc-number">2.</span> <span class="toc-text">密码学</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8EGRPC%E7%9A%84%E5%8F%8D%E7%88%AC%E8%99%AB"><span class="toc-number">3.</span> <span class="toc-text">基于GRPC的反爬虫</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E9%89%B4%E6%9D%83%E7%BB%95%E8%BF%87"><span class="toc-number">4.</span> <span class="toc-text">一、鉴权绕过</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E9%89%B4%E6%9D%83%E5%BC%95%E5%85%A5%E6%96%B9%E5%BC%8F"><span class="toc-number">5.</span> <span class="toc-text">二、鉴权引入方式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E8%AE%BE%E5%A4%87%E6%8C%87%E7%BA%B9%E6%8C%96%E6%8E%98%E5%92%8C%E8%AE%BE%E8%AE%A1"><span class="toc-number">6.</span> <span class="toc-text">三、设备指纹挖掘和设计</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81TLS%E6%A3%80%E6%B5%8B%E7%9A%84%E5%85%B7%E4%BD%93%E8%AE%BE%E8%AE%A1"><span class="toc-number">7.</span> <span class="toc-text">四、TLS检测的具体设计</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E8%AF%B7%E6%B1%82%E6%8B%A6%E6%88%AA%E5%BC%95%E5%85%A5%E8%AE%BE%E8%AE%A1"><span class="toc-number">8.</span> <span class="toc-text">五、请求拦截引入设计</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%85%B3%E4%BA%8E%E9%89%B4%E6%9D%83%E6%80%BB%E7%BB%93"><span class="toc-number">9.</span> <span class="toc-text">六、关于鉴权总结</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        爬虫&amp;反爬&amp;反反爬&amp;风控
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">hybpjx</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-08-22T16:15:25.000Z" class="dt-published" itemprop="datePublished">2024-08-23</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <!-- toc -->
<hr>
<h1 id="基于反爬系统和浏览安全体系"><a href="#基于反爬系统和浏览安全体系" class="headerlink" title="基于反爬系统和浏览安全体系"></a>基于反爬系统和浏览安全体系</h1><p>相比逆向更加有亲和力，逆向只有最后一刻才能得到成就感</p>
<p>所有反爬的手段只有两个</p>
<ol>
<li>鉴权阻止进入（开发端拦截）</li>
<li>高频组织数据大面积泄露 &#x2F; 防止服务器崩溃（风控层面）</li>
</ol>
<p>app 和 web 整体的思想和逻辑是不变的</p>
<ol>
<li><p>最开始的本质只是采集数据  &gt;&gt;&gt; 因为我们在获取数据的时候 人为采集太费时间</p>
</li>
<li><p>采集数据 （招投标 工商信息。外卖 等等） 转变&gt;&gt;&gt;&gt; 采购 | 抢票 | 模拟登录 | 自动渗透| 刷票| 黄牛| &gt;&gt;&gt; 转变鉴权时期  (没有意识到数据的价值)</p>
</li>
<li><p>协议采集 逆向成本高 资源低 性能好 ＞让采集成本高 第一优先级 鉴权 高频拦截</p>
</li>
<li><p>真机采集  逆向成本低 资源高 性能低 ＞  高频拦截</p>
</li>
<li><p>web自动化 指纹浏览器 rpc rpa</p>
</li>
<li><p>app 真机 改机 沙箱 群控 rpc</p>
</li>
</ol>
<p>所谓的反爬的原理 就是利用 浏览器和协议爬虫脚本之间的区别去拦截流量</p>
<h1 id="密码学"><a href="#密码学" class="headerlink" title="密码学"></a>密码学</h1><p>明文 ——&gt; 加密——&gt; 密文——&gt; 解密——&gt; 明文</p>
<p>密码学的研究领域可分为密码编码学（cryptography）和密码分析学（cryptanalysis）两个分支</p>
<p>类似于反爬与爬虫 前者负责加密  后者负责加密</p>
<p>举个例子</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript">code_book = &#123;<br>    <span class="hljs-string">&quot;a&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>    <span class="hljs-string">&quot;b&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>,<br>    <span class="hljs-string">&quot;c&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>,<br>&#125;<br><br>def <span class="hljs-title function_">encrypt</span>(t):<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-title function_">join</span>([code_book[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> t])<br><br>name = <span class="hljs-string">&quot;bccba&quot;</span><br><span class="hljs-title function_">print</span>(<span class="hljs-title function_">encrypt</span>(name))<br></code></pre></td></tr></table></figure>

<p>这就完成了 bccba 到 23321的过程</p>
<p>常用加密算法</p>
<ol>
<li>对称加密算法： AES 、DES、 3DES、</li>
<li>国密 SM1234</li>
<li>非对称加密算法：RSA、DCC、DSA</li>
<li>哈希摘要算法：MD5、Sha系列、</li>
</ol>
<h1 id="基于GRPC的反爬虫"><a href="#基于GRPC的反爬虫" class="headerlink" title="基于GRPC的反爬虫"></a>基于GRPC的反爬虫</h1><p>PB的技术实现。序列化和反序列化</p>
<p><a target="_blank" rel="noopener" href="https://github.com/protocolbuffers/protobuf">https://github.com/protocolbuffers/protobuf</a></p>
<p>原理就是读取 proto文件从而解析 获取里面的pack 和 message </p>
<p>进而创建一个数据载荷。然后把这个数据载荷去发送</p>
<p>要明白攻击者的方式。这很重要。没有攻击何谈防御？</p>
<h1 id="一、鉴权绕过"><a href="#一、鉴权绕过" class="headerlink" title="一、鉴权绕过"></a>一、鉴权绕过</h1><p>以web为例 常见的鉴权绕过有以下几种</p>
<ol>
<li>攻击者以鉴权去猜测实现逻辑和原理<ol>
<li>适用场景：鉴权很容易，基本一眼或者是hook一下就能搞出来的逆向，常见：base64 md5  hash等</li>
<li>对抗方法：提升加密的强度，把简单的加密更换掉（des）</li>
</ol>
</li>
<li>攻击者通过JS逆向，复现前端的加密，改写为爬虫程序能够运行加密方法（即，纯算，在爬虫圈使用纯算绕过强校验鉴权）<ol>
<li>适用场景：防御者使用的加密简单且标准，通常为标准的AES等算法，或者虽然是防御自设算法，但是算法长度很短（纯逻辑仅几百或者几十行）</li>
<li>对抗方式：提升鉴权的加密强度，使用魔改标准算法或者更强的自研算法</li>
</ol>
</li>
<li>攻击者通过JS逆向，将前端的核心加密代码剥离出来，利用Node 或者其他引擎模拟执行JS<ol>
<li>适用场景：防御者的加密较为复杂，但是代码相对来说容易读懂，能够大致或者相对容易找到核心代码，并且扣除玻璃代码部分相对容易。</li>
<li>对抗方式：增加反渗透能力（包括但不局限于：控制台检测，JS代码混淆，逻辑VMP，wasm，鼠标指纹融合）</li>
</ol>
</li>
<li>攻击者通过JS逆向和开发能力，将前端的大部分核心函数全部获取，利用Node去模拟执行——补环境。<ol>
<li>适用场景：JS执行引擎的时候，不管难度如何，只要锁定核心代码，直接执行即可。</li>
<li>对抗方式：在鉴权的时候，加入设备指纹，环境指纹（1.可以对抗补环境，2. 可以为后续流量风控收集数据）</li>
</ol>
</li>
<li>攻击者使用RPA&#x2F;RPC&#x2F;指纹浏览器&#x2F;自动化&#x2F;真机&#x2F;进行实时采集。指纹与真实浏览器相差无几。<ol>
<li>适用场景：逆向难度高，破解鉴权难度大，数据量小，且需求为一次性需求。</li>
<li>对抗方式：利用大数据风控与业务侧相结合。增加对方采集成本，比如账号 IP 、</li>
</ol>
</li>
</ol>
<p>整个Web主流的手段路径就是这些 冷门的暂时不记录了。逆向是挖洞绕过门，反爬是造门。防止大部分进入就行了。永远记住，反爬只是拦截流量 而不是锁死流量。</p>
<p>少部分进入 再通过风控分析 逐步封死</p>
<p>APP端：算法方面能精通且能稳定爬取已经是人中龙凤。更多的还是针对设备指纹方面的对抗，大部分都是基于对端的hook以及防护检测。</p>
<h1 id="二、鉴权引入方式"><a href="#二、鉴权引入方式" class="headerlink" title="二、鉴权引入方式"></a>二、鉴权引入方式</h1><table>
<thead>
<tr>
<th></th>
<th><strong>Cookie</strong></th>
<th><strong>Header</strong></th>
<th><strong>params-get</strong></th>
<th><strong>params-post</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>持久性</strong></td>
<td>自由设置</td>
<td>仅支持一次请求</td>
<td>仅支持一次请求</td>
<td>仅支持一次请求</td>
</tr>
<tr>
<td><strong>兼容性</strong></td>
<td>良好</td>
<td>优秀</td>
<td>优秀</td>
<td>优秀</td>
</tr>
<tr>
<td><strong>自由度</strong></td>
<td>高</td>
<td>低</td>
<td>低</td>
<td>低</td>
</tr>
<tr>
<td><strong>长度限制</strong></td>
<td>4k</td>
<td>64k</td>
<td>2k</td>
<td>理论上无限制</td>
</tr>
<tr>
<td><strong>业务对接</strong></td>
<td>方便</td>
<td>一般</td>
<td>一般</td>
<td>较差</td>
</tr>
</tbody></table>
<p>某些引入方式很简单 不同公司和业务选型不同 可以同时选择多种</p>
<p>某些头部尤其是国外设计。会多种整合到一起。</p>
<h1 id="三、设备指纹挖掘和设计"><a href="#三、设备指纹挖掘和设计" class="headerlink" title="三、设备指纹挖掘和设计"></a>三、设备指纹挖掘和设计</h1><ol>
<li><p>挖掘路线</p>
<ol>
<li>工作量大 推进难度大 也是最能体现价值的地方对于特性的挖掘越深入，兼容性就会处理的越好。最后的 结果就越好，整体难度防守就高。</li>
</ol>
</li>
<li><p>在鉴权检测中渗入设备指纹的主要目的</p>
<ol>
<li>对抗补环境（主要功能） </li>
<li>为大数据流量风控提供数据基础（主要功能 ）</li>
<li>为加密提供更多的原始数据，增加破解难度</li>
</ol>
</li>
<li><p>植入设备指纹的注意事项</p>
<ol>
<li>多版本浏览器的兼容性</li>
<li>低端 配置客户端的执行效率与兼容性</li>
<li>需要对指纹进行合理的分配（即合理搭配植入的方式）</li>
</ol>
</li>
<li><p>植入常见方式（通常下面几个方式会综合出现）</p>
<ol>
<li>将植入的指纹以明文加密形式传输给解密服务器</li>
<li>将植入的指纹以映射压缩的形式传输给解密服务器</li>
<li>将植入的指纹以破坏性压缩（hash 等摘要算法）再加密或者直接传输给解密服务器</li>
<li>将指纹合法性提前计算，并传输给解密服务器</li>
</ol>
</li>
<li><p>关于语言特性问题</p>
<p>这部分严格来说，不算设备指纹，但是一般情况下，在攻击者视角与设备指纹的拦截成都是类似的，所以勉强可以划分进来。在某些不同浏览器 中有众多神奇的特性，可以用来判断段明文来源是否符合浏览器特征</p>
</li>
</ol>
<h1 id="四、TLS检测的具体设计"><a href="#四、TLS检测的具体设计" class="headerlink" title="四、TLS检测的具体设计"></a>四、TLS检测的具体设计</h1><ol>
<li><p>tls检测设计</p>
<ol>
<li>不同网络环境下，不同的浏览器&#x2F;系统，都对应着不同的tls指纹，但是 所有的请求库在没有进行过魔改过下 即改底层请求的逻辑与监测点，几乎都是一致的。</li>
</ol>
</li>
<li><p>黑名单检测</p>
<ol>
<li>通过简单实验，将市面上大部分常用的请求库的特征都测试出来，然后封禁入黑名单即可。检测到黑名单就直接杀掉</li>
</ol>
</li>
<li><p>白名单检测（web） </p>
<p>难度MAX级别</p>
<p>目前为止没有产品能实现，但是海外防火墙对此方向的识别的精度就非常高。改检测方案的实现难度与工作量非常大。从三个步骤来说</p>
<ol>
<li>进行大量的的人工测试，将大部分系统(主流系统)&#x2F;浏览器（大版本即可）&#x2F;网络环境（含不同运营商）&#x2F; 平台（微信浏览器等） 指定拦截规则。</li>
<li>进行灰度测试，结合现有风控系统&#x2F; 设备指纹（UA,显卡，机器性能，网络状态..）进行策略分析，判断误杀率</li>
<li>调整拦截方案，重复进行灰度测试，直到误杀率降低至可接受范围。进而上线</li>
<li>紧盯各个版本浏览器的状态，随时判断误杀情况，避免造成生产事故。</li>
</ol>
</li>
<li><p>白名单检测 （APP）</p>
<p>由于IOS&#x2F; 安卓 发送请求时。Tls指纹不会发生改变，所以白名单很好设置。只需要把开发时设置的请求库Tls指纹设置为白名单。一般就不会出现明显异常。但是移动端爬虫还是谨慎点。策略非必要不上</p>
</li>
</ol>
<h1 id="五、请求拦截引入设计"><a href="#五、请求拦截引入设计" class="headerlink" title="五、请求拦截引入设计"></a>五、请求拦截引入设计</h1><ol>
<li><p>特点</p>
<ol>
<li>有点类似于无感验证码引入的感觉（其实就是无交互式的验证码 即无感验证码）</li>
</ol>
</li>
<li><p>优与劣</p>
<p>优势</p>
<ul>
<li>易于集成，可以通过简单的配置和嵌入代码块快速集成到现有代码中，无需参与业务代码</li>
<li>维护方便，可由专人维护，减少业务</li>
<li>维护成本低，只需要维护单JS即可</li>
<li>低耦合，符合代码规范</li>
<li>灵活性良好，业务修改与拦截无关</li>
</ul>
<p>劣势</p>
<ul>
<li>与业务代码难以绑定，安全性 会在一定程度大打折扣，可以结合验证码</li>
<li>可操作内容有限，无法与页面元素与其他参数鉴权所融合。</li>
</ul>
</li>
<li><p>适用范围</p>
<ol>
<li>业务范围广</li>
<li>所有业务均有安全性规范</li>
<li>安全性要求不高</li>
</ol>
</li>
</ol>
<h1 id="六、关于鉴权总结"><a href="#六、关于鉴权总结" class="headerlink" title="六、关于鉴权总结"></a>六、关于鉴权总结</h1><ol>
<li><p>概念明晰</p>
<p>描述反爬领域实现异常拦截的一种形式， 所谓鉴权就是鉴定权限。通过客户端传输过来的密文进行分析，确定本次请求是否合理的一种防止，而这个方式的整个过程被称之鉴权检测过程。换言之，鉴权是一个动词，针对于密文进行但请求合法性检测的整个过程。他是一个整体概念</p>
</li>
<li><p>关于数据流量风控与鉴权的关系</p>
<p>不再是单一请求，而是整体请求。 在鉴权没有办法拦截的情况而采集的一种更加强力的措施（真机对抗），所以通过鉴权过程，虽然是合法的内容，但是会留下很多设备指纹。利用这种痕迹，从宏观再去进行身份识别，确定哪些请求是同一个身份。再去拦截这个身份的过程。所以她和鉴权还是有一点差距的。反爬的目的不是拦截所有请求，而是过滤乃至增加对方的成本。彻底拦截是不显示的一件事。</p>
</li>
<li><p>一个正常的鉴权系统的要求</p>
<ol>
<li>兼容性（业务要求满足）</li>
<li>加密方案（魔改算法&#x2F;自研算法&#x2F;实验室算法）</li>
<li>反渗透方案（混淆，测试拦截，格式化检测）</li>
<li>性能</li>
<li>设备指纹 环境的挖掘</li>
<li>鉴权检测系统</li>
<li>蜜罐埋点设计</li>
<li>格式与传值内容规范</li>
<li>传值多样性 接口多样性</li>
</ol>
</li>
</ol>

  </div>
</article>


    <div class="blog-post-comments">
        <div id="utterances_thread">
            <noscript>加载评论需要在浏览器启用 JavaScript 脚本支持。</noscript>
        </div>
    </div>


        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">首页</a></li>
        
          <li><a href="/about/">关于</a></li>
        
          <li><a href="/archives/">归档</a></li>
        
          <li><a href="/tags/">标签</a></li>
        
          <li><a href="/categories/">分类</a></li>
        
          <li><a href="/friends/">友联</a></li>
        
          <li><a href="/message/">留言板</a></li>
        
          <li><a href="/essays/">说说</a></li>
        
          <li><a href="/masonry/">相册</a></li>
        
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E5%8F%8D%E7%88%AC%E7%B3%BB%E7%BB%9F%E5%92%8C%E6%B5%8F%E8%A7%88%E5%AE%89%E5%85%A8%E4%BD%93%E7%B3%BB"><span class="toc-number">1.</span> <span class="toc-text">基于反爬系统和浏览安全体系</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E5%AD%A6"><span class="toc-number">2.</span> <span class="toc-text">密码学</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8EGRPC%E7%9A%84%E5%8F%8D%E7%88%AC%E8%99%AB"><span class="toc-number">3.</span> <span class="toc-text">基于GRPC的反爬虫</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E9%89%B4%E6%9D%83%E7%BB%95%E8%BF%87"><span class="toc-number">4.</span> <span class="toc-text">一、鉴权绕过</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E9%89%B4%E6%9D%83%E5%BC%95%E5%85%A5%E6%96%B9%E5%BC%8F"><span class="toc-number">5.</span> <span class="toc-text">二、鉴权引入方式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E8%AE%BE%E5%A4%87%E6%8C%87%E7%BA%B9%E6%8C%96%E6%8E%98%E5%92%8C%E8%AE%BE%E8%AE%A1"><span class="toc-number">6.</span> <span class="toc-text">三、设备指纹挖掘和设计</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81TLS%E6%A3%80%E6%B5%8B%E7%9A%84%E5%85%B7%E4%BD%93%E8%AE%BE%E8%AE%A1"><span class="toc-number">7.</span> <span class="toc-text">四、TLS检测的具体设计</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E8%AF%B7%E6%B1%82%E6%8B%A6%E6%88%AA%E5%BC%95%E5%85%A5%E8%AE%BE%E8%AE%A1"><span class="toc-number">8.</span> <span class="toc-text">五、请求拦截引入设计</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%85%B3%E4%BA%8E%E9%89%B4%E6%9D%83%E6%80%BB%E7%BB%93"><span class="toc-number">9.</span> <span class="toc-text">六、关于鉴权总结</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/&text=爬虫&amp;反爬&amp;反反爬&amp;风控"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/&title=爬虫&amp;反爬&amp;反反爬&amp;风控"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/&is_video=false&description=爬虫&amp;反爬&amp;反反爬&amp;风控"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=爬虫&amp;反爬&amp;反反爬&amp;风控&body=Check out this article: https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/&title=爬虫&amp;反爬&amp;反反爬&amp;风控"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/&title=爬虫&amp;反爬&amp;反反爬&amp;风控"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/&title=爬虫&amp;反爬&amp;反反爬&amp;风控"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/&title=爬虫&amp;反爬&amp;反反爬&amp;风控"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/&name=爬虫&amp;反爬&amp;反反爬&amp;风控&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://hybpjx.cn/2024/08/23/%E7%88%AC%E8%99%AB&amp;%E5%8F%8D%E7%88%AC&amp;%E5%8F%8D%E5%8F%8D%E7%88%AC&amp;%E9%A3%8E%E6%8E%A7/&t=爬虫&amp;反爬&amp;反反爬&amp;风控"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2025
    hybpjx
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/tags/">标签</a></li><!--
     --><!--
       --><li><a href="/categories/">分类</a></li><!--
     --><!--
       --><li><a href="/friends/">友联</a></li><!--
     --><!--
       --><li><a href="/message/">留言板</a></li><!--
     --><!--
       --><li><a href="/essays/">说说</a></li><!--
     --><!--
       --><li><a href="/masonry/">相册</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

    <script type="text/javascript">
      var utterances_repo = 'hybpjx/hybpjx.github.io';
      var utterances_issue_term = 'pathname';
      var utterances_label = 'Comment';
      var utterances_theme = 'github-dark';

      (function(){
          var script = document.createElement('script');

          script.src = 'https://utteranc.es/client.js';
          script.setAttribute('repo', utterances_repo);
          script.setAttribute('issue-term', 'pathname');
          script.setAttribute('label', utterances_label);
          script.setAttribute('theme', utterances_theme);
          script.setAttribute('crossorigin', 'anonymous');
          script.async = true;
          (document.getElementById('utterances_thread')).appendChild(script);
      }());
  </script>

</body>
</html>
